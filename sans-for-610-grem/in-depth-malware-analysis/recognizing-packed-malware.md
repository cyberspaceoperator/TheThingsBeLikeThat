# Recognizing Packed Malware

## Packing

UPX, common and free and relatively simple to unpack

* One of the few packers with self-UNPACKING capability
* Some other packers include Armadillo, FSG, Themida, and many others

What is packing?

* Not inherently malicious, many software companies pack their software to help from being reverse engineered

Packers are tools that compress, obfuscate, encrypt, or otherwise encode the original code

The packed program decodes the code into memory when it runs

This safeguards the specimin from static analysis techniques

**Packed programs are also difficult to disassemble and debug**

Not all malware is packed

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### What can a packer hide?

* Sections - Regions of code or data that comprise the executable file, which will be loaded into memory
* Entry Point - Address of the first instructino in the program
* Import Address Table - Pointers to functions in external DLLs (that is, API calls)

### Determine packed executable

Quick approach:\


* Few strings
* byte values in the file or some its sections are too random
* few imports
* Sections named "UPX" or other packer

1. Load executable into PEStudio
2. Check section names
3. Check entropy - 0 thru 8, Closer to 8 is higher and more likely to be packed
   1. Entropy is in the "Sections" tab of PEStudio
4. **Virtual-size** being a non-zero value vs raw-size being 0. If the raw size is 0 and the virtual size is larger than 0, it could be because that's where the unpacked portion of the program will go



## Tools / Packers

Tools / Packers

| Tool           | Usage                                                                  | Description                                          |
| -------------- | ---------------------------------------------------------------------- | ---------------------------------------------------- |
| UPX (packer)   |                                                                        |                                                      |
| bytehist       | <p><img src="../../.gitbook/assets/image (41).png" alt=""><br><br></p> | Generates byte-usage histograms to spot packed files |
| Detect It Easy | diec \<filename.exe>                                                   | Identifies commonly used packers                     |
| Exeinfo PE     | GUI                                                                    | Identifies commonly used packers                     |

