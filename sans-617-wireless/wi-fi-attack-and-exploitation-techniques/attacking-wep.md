# Attacking WEP

{% hint style="info" %}
Wireshark display filter "**wlan.wep.iv**"
{% endhint %}

* WEP (uses RC4 encryption) is bad...if somebody is using it, they're stupid.
* Does not enforce ICV integrity on a per-packet basis (allowing for ARP replays to speed up key recovery)
* RC4 - stream cipher, encrypts plaintext into the same length ciphertext + WEP header and ICV trailer overhead (100bytes plaintext = 108 bytes ciphertext)
* Only payload in data packets is encrypted
* Failures in WEP teach us a lot about how to exploit other wireless protocols
  * ZigBee
  * **TKIP** - suffers from frame order validation and replay attacks
  * IEEE 802.15.4
  * **DECT** - key reuse attacks
  * **Smart Cards** - cryptographic implementation vulnerabilities
  * Network Protocols
  * Cellular Systems
* Poor handling of **frame initialization vector (IV) counters**
* WEP Header (4 bytes)
* ICV at the end of the packet
* CRC 32-bit checksum (not sufficient)

![](<../../.gitbook/assets/image (62).png>)

![](<../../.gitbook/assets/image (24) (1).png>)

![](<../../.gitbook/assets/image (75) (1).png>)

![](<../../.gitbook/assets/image (55) (1).png>)

### Aircrack WEP attack

```
// reading packet capture to recover key
aircrack-ng -n 64 aircrack-data.dump
```

### Aireplay-ng

```
// set up arp replay attack to retransmit arp packets onto the network and observe responses
aireplay-ng -b 00:01:02:03:04:05:06 -h 06:07:08:09:10:11 --arpreplay mon0
```

### Wifite2 ([https://github.com/derv82/wifite2](attacking-wep.md#undefined))

{% hint style="warning" %}
Apparently this tool performs DoS when it doesn't need to, so be careful
{% endhint %}

* Automate steps associated with attacking wifi networks (WEP/WPA/WPA2)
* Provided easy interface to ident, attack, and perform password guessing operations

### airdecap-ng

* Reads encrypted pcap file, outputs unencrypted pcap file

```
airdecap-ng -w 00:01:02:03:04:05:06 <file>.dump
```
