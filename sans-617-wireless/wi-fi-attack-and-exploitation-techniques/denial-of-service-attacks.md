# Denial-of-Service Attacks

802.11W - Aims to protect against DoS, but only protects deauth and auth management frames, nothing else, leaving the AP open to other types of DoS attacks.

### Types of DoS Attacks

* Persistent - Longer duration between attacks (annoying)
  * More effective for attacker
  * May require victim to reboot to recover
* Non-Persistent
  * Only effective while attacker is in range
  * Usefor for specific attacks and exploits
  * Most common

### Physical Medium Attack

* Generating noise on wireless frequencies over 1 or more channel
* "Fork in the microwave attack"
* Wave Bubble (http://ladyada.net/make/wavebubble)



### IEEE 802.11 MAC Attacks

* Critical flaw: No per-packet authentication for frames (attacker can transmit frames from any spoofed source MAC address)

#### Resource Starvation Attack / Authentication / Association flood (https://nullsecurity.net/tools/wireless.html)

* Max of 2007 association IDs (per 802.11), each new authenticated client is given an AID (association ID)
* Need to be able to authenticate to the network
* Repeated auth/associate requests from spoofed sources
* Some APs buckle under load / reboot
* You can use a tool called **HWK**

```
hwk --iface <interface> --auth --channel <channel> --bssid <MAC> --client <MAC> --ssid <ssid>
```

### Deauth Attack

* **File2Air** (https://willhackforsushi.com/?page\_id=19)
  * Inject 802.11 packets
  * Testing how APs/STAs respond to crafted packets
  * Injects any valid 802.11 packet from binary file (libpcap file)
  * Requires modified  WLAN drivers for operation
* **Aireplay-ng**
  * Simple deauth tool
  * Sustain a DoS with a large number of deauth frames
  * Uses broadcast deauth unless "-c \<MAC>" is specified
* **MDK3** (https://tools.kali.org/wireless-attacks/mdk3)
  * Deauth everything
    * './mdk3 wlan0 d'
  * Specify a file with targets, hosts to ignore or APs to target
  * Can specifically target WPA2 and allow WEP to function

### Beacon DS Set Flood/DoS

* Forces STAs to change their channel to a wrong channel
* File2Air&#x20;

### Medium Reservation Attack

* RTS/CTS storm/flood/co-opting
* File2Air
* Scapy

![](<../../.gitbook/assets/image (47) (1).png>)

![](<../../.gitbook/assets/image (37).png>)

### TKIP QOS Replay Attack

* Need to know WPA Key because when you change the frame, you are invalidating the ICV
* 2 invalid packets over 60 second period can tell the radio to turn off, causing a DoS (Michael algorithm)
  * If you don't want to cause a DoS, you need the WPA key
* JRockets (https://willhackforsushi.com/code/jrockets-0.1.tgz)

### Mitigating 802.11 MAC DoS attacks

* In short, IEEE won't do it. It'll break too many devices (in the billions)
* You may be able to employ RF barriers to limit signals inward
* Strong Layer 2 Encryption like WPA/WPA2
* Deploy WLAN IDS
  * Identify attacks underway and locate
* Design a WLAN DoS response plan
  * What critical resources can be restored?

