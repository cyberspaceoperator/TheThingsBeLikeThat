# Exploiting Wi-Fi Hotspots

## Hotspot Architecture

Components

* **Subscribers** (hotspot customer) - Cell phone, laptop, mobile devices, etc
* **APs** - The things with SSIDs / 802.1X support, VLAN
* **Hotspot Controller** - Responsible for firewall, captive web portal, HTTP Filtering, Critical Network Service Provider \[DHCP]
* **Network Services** - DNS, Time, DHCP possibly if the controller doesn't support it, etc
* **Authentication Server** - Verifies the creds from the subscriber, info forwarded from the controller normally
*

![](<../../.gitbook/assets/image (69).png>)

## ICMPTX / IODINE / NSTX

{% embed url="https://github.com/jakkarth/icmptx" %}

{% embed url="https://github.com/yarrick/iodine" %}

* These tools are for tunneling http through ICMP or DNS, bypassing hotspot controller restrictions/authentication



## Session Hijacking Options

1. Passively monitor network for authenticated users
   1. Watch for inactivity without accessing a logout URL (this means the user didn't press logout)
   2. Spoof MAC/IP address of inactive subscriber
2. CPSCAM

### Mac Address Impersonation

```
//LINUX
// Spoof mac
sudo ifconfig en0 ether 00:00:00:00:00:00
// or
ip link set eth0 address 00:00:00:00:00:00

//WINDOWS
macshift.exe -i "wireless network connection" 00010203040506
```

### CPSCAM (Captive Portal Scam) [https://www.willhackforsushi.com/code/cpscam.pl](https://www.willhackforsushi.com/code/cpscam.pl)

* Impersonates captive portal system network traffic
* Maintains list of clients, attempts to identify clients that left the network
* Displays inactive subscribers IP and MAC

### Information Disclosure Threats

* Weak protocols
  * SMTP
  * POP3
  * HTTP
  * Instant Messaging protocols

### Spoofed Provider

* Make hotspot with same SSID as local coffee shop for instance

```
// HTTP Site Mirroring
wget -r -nH http://site.com

// Impersonate DNS server using Metasploit
# msfconsole
# msf> use auxiliary/server/fakedns
# msf auxiliary(fakedns) > set TARGETHOST x.x.x.x
# msf auxiliary > exploit
```

### Sidejacking

![](<../../.gitbook/assets/image (77) (1).png>)
